import{i as E,r as w,d as V,m as _,j as $,c as f,a as h,t as I,w as x,v as B,n as q,o as g,_ as k,k as F,f as M,b as y,e as j,l as A}from"./index-XMPtKA6H.js";const T=E("cards",()=>{const a=w(null),m=w([]),s=()=>new Promise((u,p)=>{const i=indexedDB.open("myDatabase",1);i.onupgradeneeded=o=>{o.target.result.createObjectStore("cards",{keyPath:"id",autoIncrement:!0})},i.onsuccess=()=>{a.value=i.result,u(i.result)},i.onerror=()=>{p(i.error)}});return{db:a,cards:m,openDB:s,saveCard:async u=>{a.value||(a.value=await s());const o=a.value.transaction("cards","readwrite").objectStore("cards").add(u);return new Promise((e,r)=>{o.onsuccess=()=>{e()},o.onerror=d=>{r(d.target.error)}})},getAllCards:()=>{if(!a.value)throw new Error("Database is not opened");const i=a.value.transaction("cards","readonly").objectStore("cards").getAll();return new Promise((o,e)=>{i.onsuccess=()=>{const r=i.result;m.value=r,o(r)},i.onerror=r=>{e(r.target.error)}})},deleteCard:u=>{if(!a.value)throw new Error("Database is not opened");const o=a.value.transaction("cards","readwrite").objectStore("cards").delete(u);return new Promise((e,r)=>{o.onsuccess=()=>{e()},o.onerror=d=>{r(d.target.error)}})},getCardById:u=>{if(!a.value)throw new Error("Database is not opened");const o=a.value.transaction("cards","readonly").objectStore("cards").get(u);return new Promise((e,r)=>{o.onsuccess=()=>{const d=o.result;e(d)},o.onerror=d=>{r(d.target.error)}})},updateCardById:(u,p)=>{if(!a.value)throw new Error("Database is not opened");const o=a.value.transaction("cards","readwrite").objectStore("cards"),e=o.get(u);return new Promise((r,d)=>{e.onsuccess=()=>{const v=e.result;if(!v){d(new Error("Card not found"));return}const S={...v,...p},D=o.put(S);D.onsuccess=()=>{const C=m.value.findIndex(U=>U.id===u);C!==-1&&(m.value[C]=S),r()},D.onerror=C=>{d(C.target.error)}},e.onerror=v=>{d(v.target.error)}})}}}),N=["name"],O=["name"],R=V({__name:"CustomInput",props:_({label:{},name:{},fullWidth:{type:Boolean},textarea:{type:Boolean}},{modelValue:{type:String},modelModifiers:{}}),emits:_(["update:modelValue"],["update:modelValue"]),setup(a,{emit:m}){const s=$(a,"modelValue"),n=a;return(l,c)=>(g(),f("label",null,[h("div",null,I(l.label),1),n.textarea?x((g(),f("textarea",{key:1,class:"custom-textarea",type:"text",name:l.name,"onUpdate:modelValue":c[1]||(c[1]=t=>s.value=t)},null,8,O)),[[B,s.value]]):x((g(),f("input",{key:0,class:q({"full-width":l.fullWidth}),type:"text",name:l.name,"onUpdate:modelValue":c[0]||(c[0]=t=>s.value=t)},null,10,N)),[[B,s.value]])]))}}),W=k(R,[["__scopeId","data-v-08e27824"]]),z=["name"],L=V({__name:"CustomTextarea",props:_({label:{},name:{}},{modelValue:{type:String},modelModifiers:{}}),emits:_(["update:modelValue"],["update:modelValue"]),setup(a,{emit:m}){const s=$(a,"modelValue");return(n,l)=>(g(),f("label",null,[h("div",null,I(n.label),1),x(h("textarea",{class:"custom-textarea",type:"text",name:n.name,"onUpdate:modelValue":l[0]||(l[0]=c=>s.value=c)},null,8,z),[[B,s.value]])]))}}),G=k(L,[["__scopeId","data-v-9d1c0ac3"]]),H=V({__name:"CustomButton",props:{label:{},disabled:{type:Boolean}},emits:["onClick"],setup(a,{emit:m}){const s=a,n=m,l=()=>{s.disabled||n("onClick")};return(c,t)=>(g(),f("div",{class:q([["button",{"button--disabled":s.disabled}],"button"]),onClick:l},I(c.label),3))}}),P=k(H,[["__scopeId","data-v-846f6b40"]]);function J(a,m){const s=new FileReader;s.onload=function(n){var l;typeof((l=n.target)==null?void 0:l.result)=="string"&&m(n.target.result)},s.readAsDataURL(a)}const K={class:"create-card-form"},Q=["src"],X=V({__name:"CreateCardForm",props:{editable:{type:Boolean},id:{}},emits:["close"],setup(a,{emit:m}){const s=m,n=a,l=T(),c=w(!1),t=F({title:"",description:"",image:""}),b=w(),u=()=>{b.value&&b.value.click()},p=e=>{try{const r=e.target;r.files&&r.files.length>0&&J(r.files[0],d=>{t.image=d})}catch{}},i=()=>{t.image="",t.description="",t.title=""},o=()=>{if(c.value=!0,n.editable&&n.id){l.updateCardById(n.id,{title:t.title,description:t.description,image:t.image}).then(e=>{s("close")});return}l.saveCard({title:t.title,description:t.description,image:t.image}).then(e=>{c.value=!1,i()})};return M(async()=>{if(n.editable&&n.id){const e=await l.getCardById(n.id);e&&(t.title=e.title,t.description=e.description,t.image=e.image)}}),(e,r)=>(g(),f("div",K,[y(W,{"full-width":"",label:e.$t("message.createCard.title"),name:"title",modelValue:t.title,"onUpdate:modelValue":r[0]||(r[0]=d=>t.title=d)},null,8,["label","modelValue"]),y(G,{"full-width":"",label:e.$t("message.createCard.title"),name:"title",modelValue:t.description,"onUpdate:modelValue":r[1]||(r[1]=d=>t.description=d)},null,8,["label","modelValue"]),x(h("input",{ref_key:"filePicker",ref:b,type:"file",accept:"image/*",onChange:p},null,544),[[A,!1]]),y(P,{label:e.$t("message.createCard.selectImage"),onOnClick:u},null,8,["label"]),t.image?(g(),f("img",{key:0,class:"create-card-form__image-preview",src:t.image,alt:"Uploaded Image",style:{"max-width":"100%",height:"auto"}},null,8,Q)):j("",!0),y(P,{disabled:c.value,label:e.$t("message.createCard.save"),onOnClick:o},null,8,["disabled","label"])]))}}),Z=k(X,[["__scopeId","data-v-e064d06c"]]);export{Z as C,T as u};
